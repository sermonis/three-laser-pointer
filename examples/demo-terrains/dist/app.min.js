!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("THREE"),require("DatGuiDefaults"),require("Stats"),require("$")):"function"==typeof define&&define.amd?define(["THREE","DatGuiDefaults","Stats","$"],t):"object"==typeof exports?exports.NoPkgName=t(require("THREE"),require("DatGuiDefaults"),require("Stats"),require("$")):e.NoPkgName=t(e.THREE,e.DatGuiDefaults,e.Stats,e.$)}("undefined"!=typeof self?self:this,(function(e,t,n,r){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e){e.exports=JSON.parse('{"a":"1.2.0"}')},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1),i=n.n(o),a=n(2),u=n.n(a),c=n(3),s=n.n(c),l=n(4);function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function v(e){return function(){var t,n=w(e);if(b()){var r=w(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return g(this,t)}}function g(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=function(e){x(n,e);var t=v(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,n);var i={color:16711680,maxPoints:256,infLength:9999},a=Object.assign({},i,o);return(e=t.call(this,a.maxPoints,a.color))._src=new r.Vector3(0,0,0),e._raycaster=new r.Raycaster,e._infLen=a.infLength,e._meshes=[],e}return m(n,[{key:"setSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this._src=t?e.clone().applyMatrix4(t.matrixWorld):e.clone()}},{key:"getSource",value:function(){return this._src.clone()}},{key:"_raycast",value:function(e,t,n){var r=this._raycaster.intersectObjects(e,t);if(n){for(var o=0;o<r.length;o++)if(r[o].face!==n)return r[o];return null}return r.length>0?r[0]:null}},{key:"raycast",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return this._raycaster.set(e,t),this._raycast(n,o,r)}},{key:"raycastFromCamera",value:function(e,t,n,o,i,a){var u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=new r.Vector2(e/n*2-1,-t/o*2+1);return this._raycaster.setFromCamera(c,i),this._raycast(a,u,null)}},{key:"getMeshesHit",value:function(){return this._meshes}},{key:"point",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.updatePoints([this._src.x,this._src.y,this._src.z,e.x,e.y,e.z],!0),this._meshes.length=0,t&&this.material.color.setHex(t)}},{key:"pointWithRaytrace",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16;if(this.point(e,r),!(o<1)){var i=this.getSource(),a=n.direct(i,e),u=this.raycast(i,a,t);if(u){var c=this.computeReflections(e,a,u,t,o);this.updatePoints([i.x,i.y,i.z,e.x,e.y,e.z].concat(f(c)),!0)}}}},{key:"_computeReflectionsRecursive",value:function(e,t,o,i,a){var u=[],c=this;return function e(t,o,s){var l=(new r.Matrix3).getNormalMatrix(s.object.matrixWorld),f=s.face.normal.clone().applyMatrix3(l).normalize(),d=n.reflect(o,f),y=c.raycast(t,d,i,s.face);if(y){var h=y.point;u.push(h.x,h.y,h.z),u.length/3<a&&e(h,d,y)}else{var p=t.clone().add(d.multiplyScalar(c._infLen));u.push(p.x,p.y,p.z)}}(e,t,o),u}},{key:"_computeReflections",value:function(e,t,o,i,a){var u=[];for(this._meshes=[o.object];;){var c=(new r.Matrix3).getNormalMatrix(o.object.matrixWorld),s=o.face.normal.clone().applyMatrix3(c).normalize(),l=n.reflect(t,s),f=this.raycast(e,l,i,o.face);if(f){var d=f.point;if(u.push(d.x,d.y,d.z),this._meshes.push(f.object),u.length/3<a){e=d,t=l,o=f;continue}break}var y=e.clone().add(l.multiplyScalar(this._infLen));u.push(y.x,y.y,y.z);break}return u}},{key:"computeReflections",value:function(e,t,n,r,o){return this._computeReflections(e,t,n,r,o)}}],[{key:"direct",value:function(e,t){return t.clone().sub(e).normalize()}},{key:"reflect",value:function(e,t){return e.clone().sub(t.clone().multiplyScalar(2*e.dot(t)))}}]),n}(function(e){x(n,e);var t=v(n);function n(e){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16711680;h(this,n);var a=new r.BufferGeometry,u=new Float32Array(3*e);a.setAttribute("position",new r.BufferAttribute(u,3));var c=new r.LineBasicMaterial({color:i});return(o=t.call(this,a,c)).version=l.a,o._maxPoints=e,o._numPoints=0,o}return m(n,[{key:"_frustumCullingWorkaround",value:function(){this.geometry.computeBoundingSphere()}},{key:"setColor",value:function(e){this.material.color.setHex(e)}},{key:"getColor",value:function(){return this.material.color}},{key:"getPoints",value:function(){for(var e=this.geometry.attributes.position.array,t=[],n=0;n<this._numPoints;n++)t.push(new r.Vector3(e[3*n],e[3*n+1],e[3*n+2]));return t}},{key:"updatePoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||(e=M.flattenPoints(e));var n=this.geometry.attributes.position,r=n.count,o=e.length/3;o>r&&(o=r);for(var i=0;i<o;i++)n.array[3*i]=e[3*i],n.array[3*i+1]=e[3*i+1],n.array[3*i+2]=e[3*i+2];n.needsUpdate=!0,this.geometry.setDrawRange(0,o),this._frustumCullingWorkaround(),this._numPoints=o}},{key:"clearPoints",value:function(){this.updatePoints([],!0)}},{key:"updatePointsRandomWalk",value:function(e){this.updatePoints(n._getPointsRandomWalk(e),!0)}}],[{key:"_getPointsRandomWalk",value:function(e){for(var t=[],n=0,r=0,o=0,i=0;i<e;i++)t.push(n),t.push(r),t.push(o),n+=2*(Math.random()-.5),r+=2*(Math.random()-.5),o+=2*(Math.random()-.5);return t}},{key:"flattenPoints",value:function(e){return e.map((function(e){return[e.x,e.y,e.z]})).reduce((function(e,t){return e.concat(t)}))}}]),n}(r.Line)),k=M;function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var j=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};P(this,e);var n={xSize:1,ySize:1,maxHeight:.1,minHeight:-.1,xS:63,yS:63},r=Object.assign({},n,t);this.xSize=r.xSize,this.ySize=r.ySize,this.maxHeight=r.maxHeight,this.minHeight=r.minHeight,this.xS=r.xS,this.yS=r.yS}var t,n,o;return t=e,o=[{key:"loadHeightmapImage",value:function(e,t){var n=new Image;n.onload=function(){t(n)},n.src=e}},{key:"getBlendedMaterial",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.01,n=new r.TextureLoader;n.load("./sand1.jpg",(function(o){o.wrapS=o.wrapT=r.RepeatWrapping,n.load("./grass1.jpg",(function(i){n.load("./stone1.jpg",(function(a){n.load("./snow1.jpg",(function(n){var u=r.Terrain.generateBlendedMaterial([{texture:o},{texture:i,levels:[-80*t,-35*t,20*t,50*t]},{texture:a,levels:[20*t,50*t,60*t,85*t]},{texture:n,glsl:"1.0 - smoothstep(".concat(65*t," + smoothstep(-256.0, 256.0, vPosition.x) * ").concat(10*t,", ").concat(80*t,", vPosition.z)")},{texture:a,glsl:"slope > 0.7853981633974483 ? 0.2 : 1.0 - smoothstep(0.47123889803846897, 0.7853981633974483, slope) + 0.2"}]);e(u)}))}))}))}))}},{key:"buildTree",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=[new r.MeshLambertMaterial({color:4007959}),new r.MeshLambertMaterial({color:2968606})],n=new r.Mesh(new r.CylinderGeometry(2*e,2*e,12*e,6*e,1*e,!0));n.position.y=6*e;var o=new r.Mesh(new r.CylinderGeometry(0*e,10*e,14*e,8*e));o.position.y=18*e;var i=new r.Mesh(new r.CylinderGeometry(0*e,9*e,13*e,8*e));i.position.y=25*e;var a=new r.Mesh(new r.CylinderGeometry(0*e,8*e,12*e,8*e));a.position.y=32*e;var u=new r.Geometry;n.updateMatrix(),o.updateMatrix(),i.updateMatrix(),a.updateMatrix(),u.merge(n.geometry,n.matrix),u.merge(o.geometry,o.matrix),u.merge(i.geometry,i.matrix),u.merge(a.geometry,a.matrix);for(var c=n.geometry.faces.length,s=0,l=u.faces.length;s<l;s++)u.faces[s].materialIndex=s<c?0:1;var f=new r.Mesh(u,t);return f.scale.x=f.scale.z=5,f.scale.y=1.25,f}},{key:"getSkyDome",value:function(e){(new r.TextureLoader).load("./sky1.jpg",(function(t){t.minFilter=r.LinearFilter;var n=new r.Mesh(new r.SphereGeometry(8192,16,16,0,2*Math.PI,0,.5*Math.PI),new r.MeshBasicMaterial({map:t,side:r.BackSide,fog:!1}));n.position.y=-.99,e(n)}))}},{key:"getWater",value:function(){var e=new r.Mesh(new r.PlaneBufferGeometry(17408,17408,16,16),new r.MeshLambertMaterial({color:27552,transparent:!0,opacity:.6}));return e.position.y=-.99,e.rotation.x=-.5*Math.PI,e}},{key:"getSunLight",value:function(){var e=new r.DirectionalLight(15252912,1.5);return e.position.set(2950,2625,-160),e}},{key:"getSkyLight",value:function(){var e=new r.DirectionalLight(12839679,.75);return e.position.set(-1,-.5,-1),e}}],(n=[{key:"getTerrainScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Terrain.DiamondSquare;return r.Terrain({easing:r.Terrain.Linear,frequency:2.5,heightmap:t,material:e,steps:1,useBufferGeometry:!1,xSize:this.xSize,ySize:this.ySize,maxHeight:this.maxHeight,minHeight:this.minHeight,xSegments:this.xS,ySegments:this.yS})}},{key:"getScatterMeshesScene",value:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.001,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.02,a=e.buildTree(o);return n||(a.geometry=(new r.BufferGeometry).fromGeometry(a.geometry)),{scene:r.Terrain.ScatterMeshes(t,{mesh:a,w:this.xS,h:this.yS,spread:i,randomness:Math.random}),material:a.material}}}])&&_(t.prototype,n),o&&_(t,o),e}();function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function z(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var A=r.OrbitControls,G=document.getElementById("canvas"),B=new r.PerspectiveCamera(75,G.width/G.height,.001,1e4);B.position.set(0,0,.5),B.up=new r.Vector3(0,1,0);var W=new r.WebGLRenderer({canvas:G}),I=new A(B,W.domElement),F=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=G.clientWidth,n=G.clientHeight;(e||G.width!=t||G.height!=n)&&(W.setSize(t,n,!1),B.aspect=t/n,B.updateProjectionMatrix())};F(!0);var q=function(){var e=new r.Scene,t=function(){W.render(e,B)};e.add(new r.AxesHelper(1));var n=new r.Mesh(new r.BoxGeometry(1,1,1),new r.MeshPhongMaterial({color:12640448,side:r.BackSide,wireframe:!0,opacity:1,transparent:!0}));n.name="walls",e.add(n);var o=new k({color:16711680});e.add(o);var i=new j({xSize:1,ySize:1,maxHeight:.1,minHeight:-.1}),a=[];j.getBlendedMaterial((function(n){j.loadHeightmapImage("./heightmapMods.png",(function(r){var o=i.getTerrainScene(n,r),u=o.children[0];u.name="terrain",a.push(u);var c=i.getScatterMeshesScene(u.geometry,!1).scene;o.add(c),a=a.concat(c.children),e.add(o),t()}))})),j.getSkyDome((function(n){e.add(n),t()})),e.add(j.getWater()),e.add(j.getSunLight()),e.add(j.getSkyLight());var u=new r.MeshBasicMaterial({color:5596842,wireframe:!0}),c=s()("#msg"),l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;return"(".concat(e.x.toFixed(t),", ").concat(e.y.toFixed(t),", ").concat(e.z.toFixed(t),")")},f=function(e){var t=e.getPoints(),n=t.shift();t.pop();c.empty(),t.length>0&&(c.append("<div>laser source: ".concat(l(n),"</div>")),c.append("<div># reflections: ".concat(t.length,"</div>")),c.append("<div>reflection points: ".concat(t.map((function(e){return l(e)})).join(", "),"</div>")))},d=function(e){if(c.empty(),1===e.length)c.append("<div>points: ".concat(l(e[0])," -> </div>"));else if(2===e.length){var t=H(e,2),n=t[0],r=t[1];c.append("<div>points: ".concat(l(n)," -> ").concat(l(r),"</div>")),c.append("<div>length: ".concat(n.distanceTo(r).toFixed(3),"</div>"))}},y=new k({maxPoints:2});e.add(y);var h,p=[];return{scene:e,render:t,mark:function(t,n){if("Measure"===Y.laserMode){var r=o.raycastFromCamera(t,n,G.width,G.height,B,a);if(null!==r){var i=r.point;if(1===p.length){p.push(i);var u=new k({maxPoints:2,color:h});u.updatePoints(p),e.add(u)}else p=[i],h=Math.floor(16777215*Math.random())}Y.evRender&&U(),d(p)}},markCancel:function(){d(p=[]),y.visible=!1,Y.evRender&&U()},pick:function(e,t){if("None"!==Y.laserMode){var n=o.raycastFromCamera(e,t,G.width,G.height,B,a);if(null!==n){var i=n.point,c=new r.Vector3(.003,-.004,.002);if("Raytrace"===Y.laserMode)o.setSource(c,B),o.pointWithRaytrace(i,a,65535,16),o.getMeshesHit().forEach((function(e){"terrain"!==e.name&&(e.material=u)}));else"Measure"===Y.laserMode&&(o.setSource(c,B),o.point(i,16777215),1===p.length?(y.setSource(p[0]),y.point(i,h),y.visible=!0):y.visible=!1)}else o.clearPoints();Y.evRender&&U(),"Raytrace"===Y.laserMode&&f(o)}else o.clearPoints()}}}(),N=function(e){q.scene.traverse((function(t){if(!(!t instanceof r.Mesh)&&t.name&&"terrain"===t.name)switch(e){case"Textured":t.material.wireframe=!1,t.material.needsUpdate=!0,t.visible=!0;break;case"Wireframe":t.material.wireframe=!0,t.material.needsUpdate=!0,t.visible=!0;break;case"None":t.visible=!1}})),q.render()},$=new u.a;$.showPanel(1),document.body.appendChild($.dom);var U=function(){$.update(),F(),q.render()},V=!0,J=function(e){e?V=!0:(V=!1,function e(){V||(requestAnimationFrame(e),U())}())},X=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(a,e);var t,n,r,o,i=(t=a,function(){var e,n=E(t);if(z()){var r=E(this).constructor;e=Reflect.construct(n,arguments,r)}else e=n.apply(this,arguments);return T(this,e)});function a(){return O(this,a),i.apply(this,arguments)}return n=a,(r=[{key:"initGui",value:function(e,t,n){var r=this;e.add(n,"laserMode",["Raytrace","Measure","None"]).name("Laser Mode").onChange((function(e){t.laserMode=e})),e.add(n,"vis",["Textured","Wireframe","None"]).name("Terrain").onChange((function(e){N(e),t.vis=e})),e.add(n,"evRender").name("Passive Render").onChange((function(e){J(e),t.evRender=e})),e.add(n,"reset").name("Reset").onChange((function(e){r.applyDefaults(),N(n.vis),n.laserMode,J(n.evRender),Object.assign(t,n)})),e.add(n,"sourceCode").name("Source Code").onChange((function(e){window.location.href="https://github.com/w3reality/three-laser-pointer/tree/master/examples/demo-terrains"}))}}])&&C(n.prototype,r),o&&C(n,o),a}(i.a),Y={vis:"Textured",laserMode:"Raytrace",evRender:!0};new X(Y).setDefaults({vis:Y.vis,laserMode:Y.laserMode,evRender:Y.evRender,reset:function(){},sourceCode:function(){}});var K=function(e){var t=G.getBoundingClientRect();return[e.clientX-t.left,e.clientY-t.top]},Q=!1;W.domElement.addEventListener("mousedown",(function(e){Q=!1}),!1),W.domElement.addEventListener("mousemove",(function(e){Q=!0;var t=K(e);q.pick(t[0],t[1])}),!1),W.domElement.addEventListener("mouseup",(function(e){if(Q);else if(0===e.button){var t=K(e);q.mark(t[0],t[1])}else 2===e.button&&q.markCancel()}),!1),Y.evRender&&(U(),I.addEventListener("change",U))}]).default}));