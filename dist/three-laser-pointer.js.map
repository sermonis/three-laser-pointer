{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 1ac739d14e0646fbb082","webpack:///./src/index.js","webpack:///external \"THREE\""],"names":["THREE_ES6","THREE","window","Line","maxPoints","color","geometry","BufferGeometry","positions","Float32Array","addAttribute","BufferAttribute","material","LineBasicMaterial","_maxPoints","_numPoints","computeBoundingSphere","setHex","arr","attributes","position","array","points","i","push","Vector3","isFlatten","Laser","flattenPoints","attrPos","count","numPoints","length","needsUpdate","setDrawRange","_frustumCullingWorkaround","updatePoints","_getPointsRandomWalk","x","y","z","Math","random","arrPoints","map","pt","reduce","acc","ele","concat","options","defaults","infLength","actual","Object","assign","_src","_raycaster","Raycaster","_infLen","_meshes","src","camera","clone","applyMatrix4","matrixWorld","meshes","recursive","faceExclude","isects","intersectObjects","face","origin","direction","set","_raycast","mx","my","width","height","cam","mouse","Vector2","setFromCamera","maxReflect","point","getSource","dir","direct","isect","raycast","arrRefs","computeReflections","self","me","normalMatrix","Matrix3","getNormalMatrix","object","normalWorld","normal","applyMatrix3","normalize","ref","reflect","isectNew","inf","add","multiplyScalar","_computeReflections","target","sub","d","n","dot"],"mappings":"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","file":"three-laser-pointer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LaserPointer\"] = factory(require(\"THREE\"));\n\telse\n\t\troot[\"LaserPointer\"] = factory(root[\"THREE\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 1ac739d14e0646fbb082","// if THREE is global (via script-tag loading), use that THREE to prevent\n// conflicts with ES6 version. (Line objects become broken, otherwise...)\nimport * as THREE_ES6 from 'three';\n// console.log('window.THREE:', window.THREE);\nconst THREE = window.THREE ? window.THREE : THREE_ES6;\n\nclass Line extends THREE.Line {\n    // ref. https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically\n    constructor(maxPoints, color=0xff0000) {\n        let geometry = new THREE.BufferGeometry();\n        let positions = new Float32Array( maxPoints * 3 );\n        geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n        let material = new THREE.LineBasicMaterial({\n            color: color,\n        });\n        super(geometry, material);\n\n        this._maxPoints = maxPoints;\n        this._numPoints = 0;\n    }\n    _frustumCullingWorkaround() {\n        // https://stackoverflow.com/questions/36497763/three-js-line-disappears-if-one-point-is-outside-of-the-cameras-view\n        this.geometry.computeBoundingSphere();\n        //----\n        // this.frustumCulled = false;\n    }\n\n    static _getPointsRandomWalk(numPoints) {\n        let positions = [];\n        let x = 0;\n        let y = 0;\n        let z = 0;\n        for (let i = 0; i < numPoints; i++) {\n            positions.push(x);\n            positions.push(y);\n            positions.push(z);\n            x += ( Math.random() - 0.5 ) * 2;\n            y += ( Math.random() - 0.5 ) * 2;\n            z += ( Math.random() - 0.5 ) * 2;\n        }\n        return positions;\n    }\n    setColor(color) {\n        this.material.color.setHex(color);\n    }\n    getColor() {\n        return this.material.color;\n    }\n    getPoints() {\n        let arr = this.geometry.attributes.position.array;\n        let points = [];\n        for (let i = 0; i < this._numPoints; i++) {\n            points.push(new THREE.Vector3(arr[3*i], arr[3*i+1], arr[3*i+2]));\n        }\n        return points;\n    }\n    static flattenPoints(arrPoints) {\n        return arrPoints.map(pt => [pt.x, pt.y, pt.z])\n            .reduce((acc, ele) => acc.concat(ele));\n    }\n    updatePoints(arr, isFlatten=false) {\n        if (!isFlatten) {\n            arr = Laser.flattenPoints(arr);\n        }\n        let attrPos = this.geometry.attributes.position;\n        let maxPoints = attrPos.count;\n        let numPoints = arr.length / 3;\n        // console.log(`numPoints/maxPoints: ${numPoints}/${maxPoints}`);\n        if (numPoints > maxPoints) {\n            numPoints = maxPoints;\n        }\n        for (let i = 0; i < numPoints; i++) {\n            attrPos.array[3*i] = arr[3*i];\n            attrPos.array[3*i+1] = arr[3*i+1];\n            attrPos.array[3*i+2] = arr[3*i+2];\n        }\n        attrPos.needsUpdate = true;\n        this.geometry.setDrawRange(0, numPoints);\n        this._frustumCullingWorkaround();\n        this._numPoints = numPoints;\n    }\n    clearPoints() {\n        this.updatePoints([], true);\n    }\n    updatePointsRandomWalk(numPoints) {\n        this.updatePoints(Line._getPointsRandomWalk(numPoints), true);\n    };\n}\n\nclass Laser extends Line {\n    constructor(options={}) {\n        // https://stackoverflow.com/questions/9602449/a-javascript-design-pattern-for-options-with-default-values\n        let defaults = {\n            color: 0xff0000,\n            maxPoints: 256,\n            infLength: 9999.0,\n        };\n        let actual = Object.assign({}, defaults, options);\n        super(actual.maxPoints, actual.color);\n\n        this._src = new THREE.Vector3(0, 0, 0);\n        this._raycaster = new THREE.Raycaster();\n        this._infLen = actual.infLength;\n        this._meshes = [];\n    }\n    setSource(src, camera=null) {\n        // in case camera is given, treat (x, y, z) as in the camera coords\n        this._src = camera ? src.clone().applyMatrix4(camera.matrixWorld) : src.clone();\n    }\n    getSource() {\n        return this._src.clone();\n    }\n    static direct(src, target) {\n        return target.clone().sub(src).normalize();\n    }\n    static reflect(d, n) {\n        // r = d - 2 * (d.n) n;  https://math.stackexchange.com/questions/13261/how-to-get-a-reflection-vector\n        return d.clone().sub(n.clone().multiplyScalar(2*d.dot(n)));\n    }\n    _raycast(meshes, recursive, faceExclude) {\n        let isects = this._raycaster.intersectObjects(meshes, recursive);\n        if (faceExclude) {\n            for (let i = 0; i < isects.length; i++) {\n                if (isects[i].face !== faceExclude) {\n                    return isects[i];\n                }\n            }\n            return null;\n        }\n        return isects.length > 0 ? isects[0] : null;\n    }\n    raycast(origin, direction, meshes, faceExclude=null) {\n        this._raycaster.set(origin, direction);\n        return this._raycast(meshes, false, faceExclude);\n    }\n    raycastFromCamera(mx, my, width, height, cam, meshes) {\n        let mouse = new THREE.Vector2( // normalized (-1 to +1)\n            (mx / width) * 2 - 1,\n            - (my / height) * 2 + 1);\n        // https://threejs.org/docs/#api/core/Raycaster\n        // update the picking ray with the camera and mouse position\n        this._raycaster.setFromCamera(mouse, cam);\n        return this._raycast(meshes, false, null);\n    }\n    getMeshesHit() {\n        return this._meshes;\n    }\n    point(pt, color=null) {\n        // console.log(\"point():\", this._src, pt);\n        this.updatePoints([\n            this._src.x, this._src.y, this._src.z,\n            pt.x, pt.y, pt.z], true);\n        this._meshes.length = 0;\n        if (color) {\n            this.material.color.setHex(color);\n        }\n    }\n    pointWithRaytrace(pt, meshes=[], color=null, maxReflect=16) {\n        this.point(pt, color);\n        if (maxReflect < 1) return;\n\n        let src = this.getSource();\n        let dir = Laser.direct(src, pt);\n        let isect = this.raycast(src, dir, meshes);\n        if (!isect) return;\n\n        let arrRefs = this.computeReflections(\n            pt, dir, isect, meshes, maxReflect);\n        this.updatePoints([src.x, src.y, src.z, pt.x, pt.y, pt.z, ...arrRefs], true);\n    }\n\n    // DEPRECATED: this recursive version has stack depth limitation\n    _computeReflectionsRecursive(src, dir, isect, meshes, maxReflect) {\n        const arr = [];\n\n        // https://stackoverflow.com/questions/7065120/calling-a-javascript-function-recursively\n        // https://stackoverflow.com/questions/41681357/can-a-normal-or-arrow-function-invoke-itself-from-its-body-in-a-recursive-manner\n        const self = this;\n        (function me (src, dir, isect) {\n            // https://stackoverflow.com/questions/39082673/get-face-global-normal-in-three-js\n            // console.log('local normal:', isect.face.normal);\n            let normalMatrix = new THREE.Matrix3().getNormalMatrix(isect.object.matrixWorld);\n            let normalWorld = isect.face.normal.clone().applyMatrix3(normalMatrix).normalize();\n\n            let ref = Laser.reflect(dir, normalWorld);\n            let isectNew = self.raycast(src, ref, meshes, isect.face);\n            // console.log('isectNew:', isectNew);\n\n            if (isectNew) {\n                let pt = isectNew.point;\n                arr.push(pt.x, pt.y, pt.z);\n                if (arr.length / 3 < maxReflect) {\n                    me(pt, ref, isectNew);\n                }\n            } else {\n                let inf = src.clone().add(ref.multiplyScalar(self._infLen));\n                arr.push(inf.x, inf.y, inf.z);\n            }\n        })(src, dir, isect);\n        return arr;\n    }\n\n    _computeReflections(src, dir, isect, meshes, maxReflect) {\n        const arr = [];\n        this._meshes = [isect.object]; // re-init\n\n        while (1) {\n            let normalMatrix = new THREE.Matrix3().getNormalMatrix(isect.object.matrixWorld);\n            let normalWorld = isect.face.normal.clone().applyMatrix3(normalMatrix).normalize();\n\n            let ref = Laser.reflect(dir, normalWorld);\n            let isectNew = this.raycast(src, ref, meshes, isect.face);\n            if (isectNew) {\n                let pt = isectNew.point;\n                arr.push(pt.x, pt.y, pt.z);\n                this._meshes.push(isectNew.object);\n                if (arr.length / 3 < maxReflect) {\n                    src = pt;\n                    dir = ref;\n                    isect = isectNew;\n                    continue;\n                }\n                break;\n            } else {\n                let inf = src.clone().add(ref.multiplyScalar(this._infLen));\n                arr.push(inf.x, inf.y, inf.z);\n                break;\n            }\n        }\n        return arr;\n    }\n    computeReflections(src, dir, isect, meshes, maxReflect) {\n        // return this._computeReflectionsRecursive(src, dir, isect, meshes, maxReflect);\n        return this._computeReflections(src, dir, isect, meshes, maxReflect);\n    }\n}\n\nexport default { Line, Laser };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"THREE\"\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}