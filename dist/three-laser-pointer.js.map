{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 879025b9bf1a3d9338ac","webpack:///./src/index.js","webpack:///external \"THREE\""],"names":["THREE","Line","maxPoints","color","geometry","BufferGeometry","positions","Float32Array","addAttribute","BufferAttribute","material","LineBasicMaterial","_maxPoints","_numPoints","computeBoundingSphere","arr","attributes","position","array","points","i","push","Vector3","attrPos","count","numPoints","length","needsUpdate","setDrawRange","_frustumCullingWorkaround","updatePoints","_getPointsRandomWalk","x","y","z","Math","random","Laser","options","defaults","infLength","actual","Object","assign","_src","_raycaster","Raycaster","_infLen","src","camera","clone","applyMatrix4","matrixWorld","meshes","recursive","faceExclude","isects","intersectObjects","face","origin","direction","set","_raycast","mx","my","width","height","cam","mouse","Vector2","setFromCamera","pt","setHex","maxReflect","point","getSource","dir","direct","isect","raycast","arrRefs","computeReflections","self","me","normalMatrix","Matrix3","getNormalMatrix","object","normalWorld","normal","applyMatrix3","normalize","ref","reflect","isectNew","inf","add","multiplyScalar","_computeReflections","target","sub","d","n","dot"],"mappings":"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","file":"three-laser-pointer.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"THREE\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"THREE\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"LaserPointer\"] = factory(require(\"THREE\"));\n\telse\n\t\troot[\"LaserPointer\"] = factory(root[\"THREE\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 879025b9bf1a3d9338ac","// https://threejs.org/docs/#manual/introduction/Import-via-modules\nimport * as THREE from 'three';\n\nclass Line extends THREE.Line {\n    // ref. https://stackoverflow.com/questions/31399856/drawing-a-line-with-three-js-dynamically\n    constructor(maxPoints, color=0xff0000) {\n        let geometry = new THREE.BufferGeometry();\n        let positions = new Float32Array( maxPoints * 3 );\n        geometry.addAttribute('position', new THREE.BufferAttribute(positions, 3));\n        let material = new THREE.LineBasicMaterial({\n            color: color,\n        });\n        super(geometry, material);\n\n        this._maxPoints = maxPoints;\n        this._numPoints = 0;\n    }\n    _frustumCullingWorkaround() {\n        // https://stackoverflow.com/questions/36497763/three-js-line-disappears-if-one-point-is-outside-of-the-cameras-view\n        this.geometry.computeBoundingSphere();\n        //----\n        // this.frustumCulled = false;\n    }\n\n    static _getPointsRandomWalk(numPoints) {\n        let positions = [];\n        let x = 0;\n        let y = 0;\n        let z = 0;\n        for (let i = 0; i < numPoints; i++) {\n            positions.push(x);\n            positions.push(y);\n            positions.push(z);\n            x += ( Math.random() - 0.5 ) * 2;\n            y += ( Math.random() - 0.5 ) * 2;\n            z += ( Math.random() - 0.5 ) * 2;\n        }\n        return positions;\n    }\n    getPoints() {\n        let arr = this.geometry.attributes.position.array;\n        let points = [];\n        for (let i = 0; i < this._numPoints; i++) {\n            points.push(new THREE.Vector3(arr[3*i], arr[3*i+1], arr[3*i+2]));\n        }\n        return points;\n    }\n    updatePoints(arr) {\n        let attrPos = this.geometry.attributes.position;\n        let maxPoints = attrPos.count;\n        let numPoints = arr.length / 3;\n        // console.log(`numPoints/maxPoints: ${numPoints}/${maxPoints}`);\n        if (numPoints > maxPoints) {\n            numPoints = maxPoints;\n        }\n        for (let i = 0; i < numPoints; i++) {\n            attrPos.array[3*i] = arr[3*i];\n            attrPos.array[3*i+1] = arr[3*i+1];\n            attrPos.array[3*i+2] = arr[3*i+2];\n        }\n        attrPos.needsUpdate = true;\n        this.geometry.setDrawRange(0, numPoints);\n        this._frustumCullingWorkaround();\n        this._numPoints = numPoints;\n    }\n    clearPoints() {\n        this.updatePoints([]);\n    }\n    updatePointsRandomWalk(numPoints) {\n        this.updatePoints(Line._getPointsRandomWalk(numPoints));\n    };\n}\n\nclass Laser extends Line {\n    constructor(options={}) {\n        // https://stackoverflow.com/questions/9602449/a-javascript-design-pattern-for-options-with-default-values\n        let defaults = {\n            color: 0xff0000,\n            maxPoints: 256,\n            infLength: 9999,\n        };\n        let actual = Object.assign({}, defaults, options);\n        super(actual.maxPoints, actual.color);\n\n        this._src = new THREE.Vector3(0, 0, 0);\n        this._raycaster = new THREE.Raycaster();\n        this._infLen = actual.infLength;\n    }\n    setSource(src, camera=null) {\n        // in case camera is given, treat (x, y, z) as in the camera coords\n        this._src = camera ? src.clone().applyMatrix4(camera.matrixWorld) : src.clone();\n    }\n    getSource() {\n        return this._src.clone();\n    }\n    static direct(src, target) {\n        return target.clone().sub(src).normalize();\n    }\n    static reflect(d, n) {\n        // r = d - 2 * (d.n) n;  https://math.stackexchange.com/questions/13261/how-to-get-a-reflection-vector\n        return d.clone().sub(n.clone().multiplyScalar(2*d.dot(n)));\n    }\n    _raycast(meshes, recursive, faceExclude) {\n        let isects = this._raycaster.intersectObjects(meshes, recursive);\n        if (faceExclude) {\n            for (let i = 0; i < isects.length; i++) {\n                if (isects[i].face != faceExclude) {\n                    return isects[i];\n                }\n            }\n            return null;\n        }\n        return isects.length > 0 ? isects[0] : null;\n    }\n    raycast(origin, direction, meshes, faceExclude=null) {\n        this._raycaster.set(origin, direction);\n        return this._raycast(meshes, false, faceExclude);\n    }\n    raycastFromCamera(mx, my, width, height, cam, meshes, recursive=false) {\n        let mouse = new THREE.Vector2( // normalized (-1 to +1)\n            (mx / width) * 2 - 1,\n            - (my / height) * 2 + 1);\n        // https://threejs.org/docs/#api/core/Raycaster\n        // update the picking ray with the camera and mouse position\n        this._raycaster.setFromCamera(mouse, cam);\n        return this._raycast(meshes, recursive, null);\n    }\n    point(pt, color=null) {\n        // console.log(\"point():\", this._src, pt);\n        this.updatePoints([\n            this._src.x, this._src.y, this._src.z,\n            pt.x, pt.y, pt.z]);\n        if (color) {\n            this.material.color.setHex(color);\n        }\n    }\n    pointWithRaytrace(pt, meshes=[], color=null, maxReflect=16) {\n        this.point(pt, color);\n        if (maxReflect < 1) return;\n\n        let src = this.getSource();\n        let dir = Laser.direct(src, pt);\n        let isect = this.raycast(src, dir, meshes);\n        if (!isect) return;\n\n        let arrRefs = this.computeReflections(\n            pt, dir, isect, meshes, maxReflect);\n        this.updatePoints([src.x, src.y, src.z, pt.x, pt.y, pt.z, ...arrRefs]);\n    }\n\n    // DEPRECATED: this recursive version has stack depth limitation\n    _computeReflectionsRecursive(src, dir, isect, meshes, maxReflect) {\n        const arr = [];\n\n        // https://stackoverflow.com/questions/7065120/calling-a-javascript-function-recursively\n        // https://stackoverflow.com/questions/41681357/can-a-normal-or-arrow-function-invoke-itself-from-its-body-in-a-recursive-manner\n        const self = this;\n        (function me (src, dir, isect) {\n            // https://stackoverflow.com/questions/39082673/get-face-global-normal-in-three-js\n            // console.log('local normal:', isect.face.normal);\n            let normalMatrix = new THREE.Matrix3().getNormalMatrix(isect.object.matrixWorld);\n            let normalWorld = isect.face.normal.clone().applyMatrix3(normalMatrix).normalize();\n\n            let ref = Laser.reflect(dir, normalWorld);\n            let isectNew = self.raycast(src, ref, meshes, isect.face);\n            // console.log('isectNew:', isectNew);\n\n            if (isectNew) {\n                let pt = isectNew.point;\n                arr.push(pt.x, pt.y, pt.z);\n                if (arr.length / 3 < maxReflect) {\n                    me(pt, ref, isectNew);\n                }\n            } else {\n                let inf = src.clone().add(ref.multiplyScalar(self._infLen));\n                arr.push(inf.x, inf.y, inf.z);\n            }\n        })(src, dir, isect);\n        return arr;\n    }\n\n    _computeReflections(src, dir, isect, meshes, maxReflect) {\n        const arr = [];\n        while (1) {\n            let normalMatrix = new THREE.Matrix3().getNormalMatrix(isect.object.matrixWorld);\n            let normalWorld = isect.face.normal.clone().applyMatrix3(normalMatrix).normalize();\n\n            let ref = Laser.reflect(dir, normalWorld);\n            let isectNew = this.raycast(src, ref, meshes, isect.face);\n            if (isectNew) {\n                let pt = isectNew.point;\n                arr.push(pt.x, pt.y, pt.z);\n                if (arr.length / 3 < maxReflect) {\n                    src = pt;\n                    dir = ref;\n                    isect = isectNew;\n                    continue;\n                }\n                break;\n            } else {\n                let inf = src.clone().add(ref.multiplyScalar(this._infLen));\n                arr.push(inf.x, inf.y, inf.z);\n                break;\n            }\n        }\n        return arr;\n    }\n    computeReflections(src, dir, isect, meshes, maxReflect) {\n        // return this._computeReflectionsRecursive(src, dir, isect, meshes, maxReflect);\n        return this._computeReflections(src, dir, isect, meshes, maxReflect);\n    }\n}\n\nexport default { Line, Laser };\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"THREE\"\n// module id = 1\n// module chunks = 0"],"sourceRoot":""}